Hooks
==========

On this page you will learn how to use as well as how to trigger hooks. All already existing hooks are listed below.

## Usage

#### Register an action for a given hook
If you want to listen to a specific event, and trigger your own function when this event is posted, you have to define a method `getListHooksRegistered()` in your plugin class, that will return an array containing pair of (hook name, method to call).

For example if you want to execute your function `AddCityInformation()` when a new visitor is recorded by Piwik (hook `Tracker.newVisitorInformation`), in your class `MyPlugin` you would define a method:

```
function getListHooksRegistered()
{
    return array( 'Tracker.newVisitorInformation' => 'AddCityInformation' );
}
```

The hook `Tracker.newVisitorInformation` has an argument: an array containing the visitorâ€™s information. You can add new elements to this array. Example:

```
function AddCityInformation( &$visitorInfo )
{
    // we modify the variable, adding the new city field
    $visitorInfo['city'] = 'Paris, France';
}
```

You can have a look at the [provider plugin](https://github.com/piwik/piwik/blob/master/plugins/Provider/Provider.php#L31) to see an example of a plugin registering actions for multiple hooks.

Piwik also provides a means of dynamic hook registration using `Piwik_AddAction($eventName, $callback)`.

#### Add a new hook
Plugins can themselves post new events, the same way Piwik posts events. A common example is custom page headers and footers (on a per plugin basis).

```
Piwik_PostEvent( $eventName,  [ $object , [ $info ]])
```

or in Twig templates:

```
{{ '{{ postEvent($eventName) }}' }}
```
By convention, the event name should be prefixed by the Plugin name.

## Categories of existing Hooks

This is a complete list of available hooks.

{% set currentCategory = '' %}
{% for hook in hooks if hook.name != '$eventName' %}
{% if (hook.category) != (currentCategory) %}{% set currentCategory = hook.category %}
- [{{ hook.category }}](#{{ hook.category|lower }})
{% endif %}
{% endfor %}

{% set currentCategory = '' %}
{% for hook in hooks if hook.name != '$eventName' %}
{% if (hook.category) != (currentCategory) %}{% set currentCategory = hook.category %}
## {{ hook.category }}

{% for categoryHook in hooks if categoryHook.category == currentCategory %}
- [{{ categoryHook.name }}](#{{ categoryHook.name|onlyalnum|lower }})
{% endfor %}
{% endif %}

#### {{ hook.name }}
_Defined in [{{ hook.namespace }}/{{ hook.class }}](https://github.com/piwik/piwik/blob/master{{ hook.file }}) in line [{{ hook.line }}](https://github.com/piwik/piwik/blob/master{{ hook.file }}#L{{ hook.line }})_

{% if hook.comment %}
{{ hook.comment.shortDesc|raw }}{% if hook.comment.longDesc %} {{ hook.comment.longDesc|raw }}{% endif %}
{% endif %}

{% if hook.arguments %}

Callback Signature:
<pre><code>{{ hook.arguments|replace({'array(': 'function('}) }}</code></pre>
{% if hook.comment and hook.comment.params %}
{% for param in hook.comment.params %}
- {% if param[0] and param[0][0] and param[0][0][0] %}`{{ param[0][0][0] }}`{% endif %}{% if param[1] %} `${{ param[1] }}`{% endif %}{% if param[1] %} {{ param[2] }}{% endif %}

{% endfor %}
{% endif %}
{% endif %}
{% if hook.usages %}

Usages:

{% for usage in hook.usages -%}
[{{ usage.className }}::{{ usage.methodName }}](https://github.com/piwik/piwik/blob/master{{ usage.file }}#L{{ usage.startLine }}){% if not loop.last%}, {% endif %}
{% endfor %}

{% endif %}

{% endfor %}